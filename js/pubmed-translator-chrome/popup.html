<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PubMed æ–‡çŒ®æ ‡é¢˜ç¿»è¯‘ - è®¾ç½®</title>
    <link rel="stylesheet" href="popup.css">
    <script src="browser-polyfill.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”¬ PubMed æ–‡çŒ®æ ‡é¢˜ç¿»è¯‘</h1>
            <p class="version">v1.1</p>
        </div>

        <div class="section">
            <h2>åŸºç¡€è®¾ç½®</h2>
            
            <div class="form-group">
                <label for="titleProvider">æ ‡é¢˜ç¿»è¯‘æä¾›å•†</label>
                <select id="titleProvider">
                    <optgroup label="å…è´¹æœåŠ¡">
                        <option value="google">Google ç¿»è¯‘</option>
                        <option value="microsoft">Microsoft ç¿»è¯‘</option>
                    </optgroup>
                    <optgroup label="ä»˜è´¹æœåŠ¡ï¼ˆéœ€è¦ API Keyï¼‰">
                        <option value="deepl">DeepL ç¿»è¯‘</option>
                        <option value="niutrans">å°ç‰›ç¿»è¯‘</option>
                    </optgroup>
                    <optgroup label="å¤§æ¨¡å‹ï¼ˆéœ€è¦ API Keyï¼‰">
                        <option value="openai">OpenAI</option>
                        <option value="gemini">Google AI Studio (Gemini)</option>
                        <option value="openrouter">OpenRouter</option>
                        <option value="lmrouter">LMRouter</option>
                        <option value="deepseek">DeepSeek</option>
                        <option value="siliconflow">ç¡…åŸºæµåŠ¨</option>
                    </optgroup>
                </select>
            </div>

            <div class="form-group">
                <label>
                    <input type="checkbox" id="translateAbstract">
                    ç¿»è¯‘æ‘˜è¦ï¼ˆé»˜è®¤å…³é—­ï¼‰
                </label>
            </div>

                        <div class="form-group">
                <label for="abstractProvider">æ‘˜è¦ç¿»è¯‘æä¾›å•†</label>
                <select id="abstractProvider">
                    <optgroup label="å…è´¹æœåŠ¡">
                        <option value="google">Google ç¿»è¯‘</option>
                        <option value="microsoft">Microsoft ç¿»è¯‘</option>
                    </optgroup>
                    <optgroup label="ä»˜è´¹æœåŠ¡ï¼ˆéœ€è¦ API Keyï¼‰">
                        <option value="deepl">DeepL ç¿»è¯‘</option>
                        <option value="niutrans">å°ç‰›ç¿»è¯‘</option>
                    </optgroup>
                    <optgroup label="å¤§æ¨¡å‹ï¼ˆéœ€è¦ API Keyï¼‰">
                        <option value="openai">OpenAI</option>
                        <option value="gemini">Google AI Studio (Gemini)</option>
                        <option value="openrouter">OpenRouter</option>
                        <option value="lmrouter">LMRouter</option>
                        <option value="deepseek">DeepSeek</option>
                        <option value="siliconflow">ç¡…åŸºæµåŠ¨</option>
                    </optgroup>
                </select>
            </div>
        </div>

        <div class="section api-section">
            <h2 class="collapsible" data-target="api-configs">
                <span class="collapse-icon">â–¶</span> API é…ç½®
            </h2>
            <div id="api-configs" class="collapsible-content" style="display: none;">
            <p class="hint">æ ¹æ®é€‰æ‹©çš„ç¿»è¯‘æä¾›å•†å¡«å†™ç›¸åº”çš„ API Key</p>

            <!-- DeepL -->
            <div class="api-config" id="deepl-config">
                <h3>DeepL</h3>
                <div class="form-group">
                    <label for="deepl-apiKey">API Key</label>
                    <input type="password" id="deepl-apiKey" placeholder="è¾“å…¥ DeepL API Key">
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="deepl-useFreeApi">
                        ä½¿ç”¨å…è´¹ç‰ˆ API
                    </label>
                </div>
            </div>

            <!-- å°ç‰›ç¿»è¯‘ -->
            <div class="api-config" id="niutrans-config">
                <h3>å°ç‰›ç¿»è¯‘</h3>
                <div class="form-group">
                    <label for="niutrans-apiKey">API Key</label>
                    <input type="password" id="niutrans-apiKey" placeholder="è¾“å…¥å°ç‰›ç¿»è¯‘ API Key">
                </div>
            </div>

            <!-- OpenAI -->
            <div class="api-config" id="openai-config">
                <h3>OpenAI</h3>
                <div class="form-group">
                    <label for="openai-apiKey">API Key</label>
                    <input type="password" id="openai-apiKey" placeholder="è¾“å…¥ OpenAI API Key">
                </div>
                <div class="form-group">
                    <label for="openai-model">æ¨¡å‹</label>
                    <input type="text" id="openai-model" placeholder="gpt-4o-mini">
                </div>
                <div class="form-group">
                    <label for="openai-temperature">Temperature</label>
                    <input type="number" id="openai-temperature" step="0.1" min="0" max="2" placeholder="0.3">
                </div>
            </div>

            <!-- Google AI Studio (Gemini) -->
            <div class="api-config" id="gemini-config">
                <h3>Google AI Studio (Gemini)</h3>
                <div class="form-group">
                    <label for="gemini-apiKey">API Key</label>
                    <input type="password" id="gemini-apiKey" placeholder="è¾“å…¥ Google AI Studio API Key">
                </div>
                <div class="form-group">
                    <label for="gemini-model">æ¨¡å‹</label>
                    <input type="text" id="gemini-model" placeholder="gemini-2.0-flash-exp">
                </div>
                <div class="form-group">
                    <label for="gemini-temperature">Temperature</label>
                    <input type="number" id="gemini-temperature" step="0.1" min="0" max="2" placeholder="0.3">
                </div>
            </div>

            <!-- OpenRouter -->
            <div class="api-config" id="openrouter-config">
                <h3>OpenRouter</h3>
                <div class="form-group">
                    <label for="openrouter-apiKey">API Key</label>
                    <input type="password" id="openrouter-apiKey" placeholder="è¾“å…¥ OpenRouter API Key">
                </div>
                <div class="form-group">
                    <label for="openrouter-model">æ¨¡å‹</label>
                    <input type="text" id="openrouter-model" placeholder="google/gemini-2.0-flash-exp:free">
                </div>
                <div class="form-group">
                    <label for="openrouter-temperature">Temperature</label>
                    <input type="number" id="openrouter-temperature" step="0.1" min="0" max="2" placeholder="0.3">
                </div>
            </div>

            <!-- LMRouter -->
            <div class="api-config" id="lmrouter-config">
                <h3>LMRouter</h3>
                <div class="form-group">
                    <label for="lmrouter-apiKey">API Key</label>
                    <input type="password" id="lmrouter-apiKey" placeholder="è¾“å…¥ LMRouter API Key">
                </div>
                <div class="form-group">
                    <label for="lmrouter-model">æ¨¡å‹</label>
                    <input type="text" id="lmrouter-model" placeholder="google/gemini-2.0-flash-exp">
                </div>
                <div class="form-group">
                    <label for="lmrouter-temperature">Temperature</label>
                    <input type="number" id="lmrouter-temperature" step="0.1" min="0" max="2" placeholder="0.3">
                </div>
            </div>

            <!-- DeepSeek -->
            <div class="api-config" id="deepseek-config">
                <h3>DeepSeek</h3>
                <div class="form-group">
                    <label for="deepseek-apiKey">API Key</label>
                    <input type="password" id="deepseek-apiKey" placeholder="è¾“å…¥ DeepSeek API Key">
                </div>
                <div class="form-group">
                    <label for="deepseek-model">æ¨¡å‹</label>
                    <input type="text" id="deepseek-model" placeholder="deepseek-chat">
                </div>
                <div class="form-group">
                    <label for="deepseek-temperature">Temperature</label>
                    <input type="number" id="deepseek-temperature" step="0.1" min="0" max="2" placeholder="1.3">
                </div>
            </div>

            <!-- ç¡…åŸºæµåŠ¨ -->
            <div class="api-config" id="siliconflow-config">
                <h3>ç¡…åŸºæµåŠ¨</h3>
                <div class="form-group">
                    <label for="siliconflow-apiKey">API Key</label>
                    <input type="password" id="siliconflow-apiKey" placeholder="è¾“å…¥ç¡…åŸºæµåŠ¨ API Key">
                </div>
                <div class="form-group">
                    <label for="siliconflow-model">æ¨¡å‹</label>
                    <input type="text" id="siliconflow-model" placeholder="THUDM/glm-4-9b-chat">
                </div>
                <div class="form-group">
                    <label for="siliconflow-temperature">Temperature</label>
                    <input type="number" id="siliconflow-temperature" step="0.1" min="0" max="2" placeholder="0.3">
                </div>
            </div>
            </div>
        </div>

        <div class="section">
            <h2 class="collapsible" data-target="advanced-settings">
                <span class="collapse-icon">â–¶</span> é«˜çº§è®¾ç½®
            </h2>
            <div id="advanced-settings" class="collapsible-content" style="display: none;">
            <div class="form-group">
                <label for="maxConcurrent">æœ€å¤§å¹¶å‘æ•°</label>
                <input type="number" id="maxConcurrent" min="1" max="10" placeholder="2">
            </div>
            <div class="form-group">
                <label for="requestDelay">è¯·æ±‚å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰</label>
                <input type="number" id="requestDelay" min="0" placeholder="500">
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="cacheEnabled">
                    å¯ç”¨ç¿»è¯‘ç¼“å­˜ï¼ˆå‡å°‘ API è°ƒç”¨ï¼ŒèŠ‚çœè´¹ç”¨ï¼‰
                </label>
            </div>
            <div class="form-group">
                <label for="cacheDuration">ç¼“å­˜æœ‰æ•ˆæœŸï¼ˆå¤©ï¼‰</label>
                <input type="number" id="cacheDuration" min="1" max="365" placeholder="7">
                <small style="color: #666; display: block; margin-top: 4px;">
                    ç¼“å­˜ä¼šåœ¨æŒ‡å®šå¤©æ•°åè‡ªåŠ¨è¿‡æœŸå¹¶æ¸…ç†
                </small>
            </div>
            <div class="form-group">
                <button id="clearCacheBtn" class="btn btn-secondary" style="width: 100%;">
                    ğŸ—‘ï¸ æ¸…ç©ºç¿»è¯‘ç¼“å­˜
                </button>
                <div id="cacheStats" style="margin-top: 10px; font-size: 12px; color: #666;"></div>
            </div>
            
            <div class="section-divider"></div>
            
            <h3 style="margin-top: 15px; margin-bottom: 8px;">ğŸ¤– å¤§æ¨¡å‹ Prompt é…ç½®</h3>
            <p class="hint" style="margin-bottom: 10px;">
                ä»…å¯¹å¤§æ¨¡å‹ç¿»è¯‘æœåŠ¡ï¼ˆOpenAIã€Google AI Studio (Gemini)ã€OpenRouterã€LMRouterã€DeepSeekã€ç¡…åŸºæµåŠ¨ï¼‰ç”Ÿæ•ˆã€‚å¯ä»¥è‡ªå®šä¹‰ç¿»è¯‘é£æ ¼ã€æ·»åŠ æœ¯è¯­è¦æ±‚ç­‰ã€‚
            </p>
            
            <div class="form-group">
                <label for="llmSystemPrompt">
                    ç³»ç»Ÿæç¤ºè¯ï¼ˆSystem Promptï¼‰
                    <span class="label-hint">å®šä¹‰AIçš„è§’è‰²å’ŒåŸºæœ¬è¦æ±‚</span>
                </label>
                <textarea id="llmSystemPrompt" class="prompt-textarea" rows="4" placeholder="ä¾‹å¦‚ï¼šä½ æ˜¯ä¸“ä¸šçš„åŒ»å­¦ç¿»è¯‘åŠ©æ‰‹ï¼Œç²¾é€šç”Ÿç‰©åŒ»å­¦é¢†åŸŸçš„å­¦æœ¯ç¿»è¯‘..."></textarea>
            </div>
            
            <div class="form-group">
                <label for="llmUserPrompt">
                    ç”¨æˆ·æç¤ºè¯ï¼ˆUser Promptï¼‰
                    <span class="label-hint">ç¿»è¯‘æŒ‡ä»¤æ¨¡æ¿ï¼Œä½¿ç”¨ {text} è¡¨ç¤ºå¾…ç¿»è¯‘å†…å®¹</span>
                </label>
                <textarea id="llmUserPrompt" class="prompt-textarea" rows="3" placeholder="ä¾‹å¦‚ï¼šå°†ä»¥ä¸‹è‹±æ–‡ç¿»è¯‘æˆç®€ä½“ä¸­æ–‡ï¼š&#10;&#10;{text}"></textarea>
                <small style="color: #666; display: block; margin-top: 4px;">
                    ğŸ’¡ æç¤ºï¼šä½¿ç”¨ <code>{text}</code> å ä½ç¬¦è¡¨ç¤ºå¾…ç¿»è¯‘çš„æ–‡æœ¬ï¼Œç¨‹åºä¼šè‡ªåŠ¨æ›¿æ¢
                </small>
            </div>
            
            <div class="form-group">
                <button id="resetPromptsBtn" class="btn btn-secondary" style="width: 100%;">
                    ğŸ”„ æ¢å¤é»˜è®¤ Prompt
                </button>
            </div>
            </div>
        </div>

        <div class="actions">
            <button id="saveBtn" class="btn btn-primary">ä¿å­˜è®¾ç½®</button>
            <button id="resetBtn" class="btn btn-secondary">æ¢å¤é»˜è®¤</button>
        </div>

        <div class="footer">
            <p>Build by Miao and Github Copilot with â™¥</p>
            <p class="links">
                <a href="https://github.com/aoaim/luanqi_bazao/tree/main/js/pubmed-translator-chrome" target="_blank">GitHub</a>
            </p>
        </div>
    </div>

    <div id="toast" class="toast"></div>

    <script src="popup.js"></script>
</body>
</html>
